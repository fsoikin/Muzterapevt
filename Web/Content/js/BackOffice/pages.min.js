var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype,n.prototype=new r};define(["require","exports","../common","ko","ko.mapping","jQuery"],function(n,t,i,r,u,f){var s=i,e=r,h=u,a=f,c={Load:"BackOffice/Pages/All",Update:"BackOffice/Pages/Update",Create:"BackOffice/Pages/Create"},l=function(n){function t(){var t=this;n.call(this),this.Pages=e.observableArray(),s.Api.Get(c.Load,null,this.IsLoading,this.Error,function(n){return t.Pages(n.map(function(n){return new o(t,n)}))})}return __extends(t,n),t.prototype.Create=function(){var n=new o(this,null);this.Pages.push(n),n.Edit()},t}(s.VmBase),o;t.PagesVm=l,o=function(){function n(n,t){var i=this;this.Parent=n,this.Page=t,this.IsNew=e.observable(!0),this.IsSaving=e.observable(!1),this.IsEditing=e.observable(!1),this.Path=e.observable(""),this.Id=e.observable(0),t&&(h.fromJS(t,{},this),this.IsNew(!1)),this.IsEditing.subscribe(function(n){n&&i.Parent.Pages().forEach(function(n){return n==i||n.IsEditing(!1)})})}return n.prototype.Edit=function(){this.IsEditing(!0)},n.prototype.CommitEdit=function(){var n=this;this.Page=h.toJS(this),s.Api.Post(this.IsNew()?c.Create:c.Update,null,this.IsSaving,this.Parent.Error,function(){n.IsEditing(!1),n.IsNew(!1)})},n.prototype.CandelEdit=function(){this.IsEditing(!1),h.fromJS(this.Page,{},this)},n}(),t.PageVm=o})