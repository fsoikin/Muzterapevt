var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype,n.prototype=new r};define(["require","exports","../common","ko","ko.mapping","jQuery","text!./Templates/pages.html"],function(n,t,i,r,u,f,e){var s=i,o=r,c=u,p=f,l={Load:"BackOffice/Pages/All",Update:"BackOffice/Pages/Update",Create:"BackOffice/Pages/Create"},y=function(n){function t(){var t=this;n.call(this),this.Pages=o.observableArray(),this.OnLoaded=v,this.ControlsDescendantBindings=!0,s.Api.Get(l.Load,null,this.IsLoading,this.Error,function(n){return t.Pages(n.map(function(n){return new h(t,n)}))})}return __extends(t,n),t.prototype.Create=function(){var n=new h(this,null);this.Pages.push(n),n.Edit()},t}(s.VmBase),h,a,v;t.PagesVm=y,h=function(){function n(n,t){var i=this;this.Parent=n,this.Page=t,this.IsNew=o.observable(!0),this.IsSaving=o.observable(!1),this.IsEditing=o.observable(!1),this.Path=o.observable(""),this.Id=o.observable(0),t&&(c.fromJS(t,{},this),this.IsNew(!1)),this.IsEditing.subscribe(function(n){n&&i.Parent.Pages().forEach(function(n){return n==i||n.IsEditing(!1)})})}return n.prototype.Edit=function(){this.IsEditing(!0)},n.prototype.CommitEdit=function(){var n=this;this.Page=c.toJS(this),s.Api.Post(this.IsNew()?l.Create:l.Update,null,this.IsSaving,this.Parent.Error,function(){n.IsEditing(!1),n.IsNew(!1)})},n.prototype.CandelEdit=function(){this.IsEditing(!1),c.fromJS(this.Page,{},this)},n}(),t.PageVm=h,a=e,v=s.ApplyTemplate(a)})